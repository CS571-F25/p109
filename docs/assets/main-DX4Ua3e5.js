import{l as Ct}from"./index-hQWQdD6B.js";const O=2;function ft({key:e}){switch(n.velocity.x=0,n.velocity.y=0,e){case"w":n.velocity.y=-O,n.direction="up";break;case"a":n.velocity.x=-O,n.direction="left";break;case"s":n.velocity.y=O,n.direction="down";break;case"d":n.velocity.x=O,n.direction="right";break;case"Escape":J();break}}function G(){window.addEventListener("keydown",ft)}function H(){window.removeEventListener("keydown",ft)}G();const he=Object.freeze(Object.defineProperty({__proto__:null,enableWASD:G,resetWASD:H},Symbol.toStringTag,{value:"Module"})),N=document.getElementById("startScreen"),Et=document.getElementById("startButton");document.getElementById("playerName");const V=document.getElementById("gameCanvas")||document.querySelector("canvas"),K=document.getElementById("endScreen"),Dt=document.getElementById("goHomeButton");let _=!1;function At(){N.style.display="none",V.style.display="block",K.style.display="none",W(1),b(),_||(ot(),G(),zt(requestAnimationFrame(A)),_=!0)}function J(){N.style.display="none",V.style.display="none",K.style.display="block",b(),H(),_=!1}function Lt(){N.style.display="block",V.style.display="none",K.style.display="none",ot(),b(),H(),_=!1}Et.addEventListener("click",At);Dt.addEventListener("click",Lt);function Bt(){b(),H();const e=document.createElement("div");e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.backgroundColor="black",e.style.zIndex="999",document.body.appendChild(e);const t=document.createElement("div");t.innerText="Level Cleared!",t.style.color="yellow",t.style.position="absolute",t.style.font='20px "Press Start 2P", monospace',t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.fontSize="40px",t.style.zIndex="1000";const s=document.createElement("p");s.innerText="Press Enter to continue...",s.style.fontSize="20px",s.style.color="white",t.appendChild(s),document.body.appendChild(t);const i=o=>{o.key==="Enter"&&(document.body.removeChild(t),document.body.removeChild(e),W(g),G(),document.removeEventListener("keydown",i))};document.addEventListener("keydown",i)}function Ot(){f.fillStyle="white",f.font='20px "Press Start 2P", monospace',f.textAlign="left",f.fillText("SCORE",600,30),f.fillText(k.toString(),600,60)}function gt(){let i=600,o=90;for(let l=0;l<3;l++){const r=l<I?"â¤ï¸":"ðŸ¤";f.fillText(r,i+l*30,o)}}class Rt{constructor({spawnPosition:t,position:s,color:i,size:o}){this.spawnPosition=t,this.position=s,this.color=i,this.size=o,this.frightened=!1,this.eaten=!1,this.originalColor=i}draw(t,s){if(!this.eaten){t.beginPath(),t.arc(this.position.x,this.position.y,this.size,Math.PI,0);let a=this.position.x-this.size,p=this.position.x+this.size,c=this.position.y+this.size;t.lineTo(p,c);const u=2,x=.5,L=.002,j=4;for(let M=p;M>=a;M-=j){let B=Math.sin(M*x+Date.now()*L)*u;t.lineTo(M,c+B)}t.lineTo(a,c),t.lineTo(a,this.position.y),t.closePath(),t.fillStyle=this.color,t.fill()}t.beginPath(),t.arc(this.position.x-4,this.position.y-2.5,3,0,Math.PI*2),t.arc(this.position.x+4,this.position.y-2.5,3,0,Math.PI*2),t.fillStyle="white",t.fill();let i=s.position.x-this.position.x,o=s.position.y-this.position.y,l=Math.sqrt(i*i+o*o);l!==0&&(i/=l,o/=l);let r=i*1,h=o*1;t.beginPath(),t.arc(this.position.x-4+r,this.position.y-2.5+h,1.5,0,Math.PI*2),t.arc(this.position.x+4+r,this.position.y-2.5+h,1.5,0,Math.PI*2),t.fillStyle="black",t.fill()}}function $t(){let e=!1,t=null,s=!1;if(y.forEach(i=>{const o=Math.hypot(n.position.x-i.position.x,n.position.y-i.position.y),l=n.radius+i.size*.8;o<l&&(i.frightened==!0?(t=i,s=!0):i.eaten==!1&&(e=!0))}),s){if(!t)return;if(t.frightened&&!t.eaten){const i=[400,800,1600,3200];bt(i[Math.min(F,i.length-1)]),Mt(),t.turnEaten()}}else e&&(It(-1),console.log(`Player lives: ${I}`),setTimeout(()=>{e=!1},1e3),I>0?(ut(),ie()):(ut(),document.getElementById("endScImg").src=Ct,J()))}function xt(e,t,s){const i=Math.floor(t/e),o=Math.floor(s/e),l=Array.from({length:o},()=>Array(i).fill(0));return P.forEach(r=>{const h=Math.floor(r.position.x/e),a=Math.floor(r.position.y/e),p=Math.floor((r.position.x+r.width)/e),c=Math.floor((r.position.y+r.height)/e);for(let u=a;u<c;u++)for(let x=h;x<p;x++)l[u][x]=1}),l}function _t(e,t,s){const i=[{x:0,y:-1},{x:0,y:1},{x:-1,y:0},{x:1,y:0}],o=[[e]],l=new Set;for(l.add(`${e.x},${e.y}`);o.length>0;){const r=o.shift(),{x:h,y:a}=r[r.length-1];if(h===t.x&&a===t.y)return r;for(let p of i){const c={x:h+p.x,y:a+p.y};c.y>=0&&c.y<s.length&&c.x>=0&&c.x<s[0].length&&s[c.y][c.x]===0&&!l.has(`${c.x},${c.y}`)&&(l.add(`${c.x},${c.y}`),o.push([...r,c]))}}return null}class X extends Rt{constructor(t){super(t),this.tileSize=10,this.speed=.2,this.currentDirection={x:0,y:-.05},this.nextDirection=null,this.gridOffset=this.tileSize/2,this.mode="chase",this.scatterTarget=t.scatterTarget,this.wallHitCooldown=0,this.baseSpeed=this.speed,this.spawnTile={x:Math.floor(t.spawnPosition.x/this.tileSize),y:Math.floor(t.spawnPosition.y/this.tileSize)},this.eaten=!1,this.scatterTarget=t.scatterTarget,this.modeStartTime=performance.now(),this.currentModeDuration=()=>this.mode==="chase"?2e4:7e3}update(){const t=performance.now();t-this.modeStartTime>=this.getCurrentModeDuration()&&(this.switchMode(),this.modeStartTime=t);const i=xt(this.tileSize,m.width,m.height),o={x:Math.floor(this.position.x/this.tileSize),y:Math.floor(this.position.y/this.tileSize)};let l;const r={x:Math.floor(n.position.x/this.tileSize),y:Math.floor(n.position.y/this.tileSize)};if(this.eaten)l=this.spawnTile,this.speed=this.baseSpeed*4,o.x===this.spawnTile.x&&o.y===this.spawnTile.y&&(this.eaten=!1,this.frightened=!1,this.speed=this.baseSpeed,this.color=this.originalColor);else if(this.frightened){const u=o.x-r.x,x=o.y-r.y,L=Math.sqrt(u*u+x*x)||1,j=u/L,M=x/L;let B=!1;for(let T=4;T>=1;T--){const w=Math.round(o.x+j*T),v=Math.round(o.y+M*T);if(v>=0&&v<i.length&&w>=0&&w<i[0].length&&i[v][w]===0){l={x:w,y:v},B=!0;break}}if(!B){const T=[];for(let w=0;w<i.length;w++)for(let v=0;v<i[0].length;v++)i[w][v]===0&&T.push({x:v,y:w});l=T[Math.floor(Math.random()*T.length)]}}else l=this.getTargetTile?this.getTargetTile():r;if(Math.abs(this.position.x-(o.x*this.tileSize+this.gridOffset))<this.speed*2&&Math.abs(this.position.y-(o.y*this.tileSize+this.gridOffset))<this.speed*2){const u=_t(o,l,i);if(u&&u.length>1){u.shift();const x=u[0];this.nextDirection={x:x.x-o.x,y:x.y-o.y}}this.nextDirection&&(this.currentDirection=this.nextDirection,this.nextDirection=null)}const a=this.position.x+this.currentDirection.x*this.speed,p=this.position.y+this.currentDirection.y*this.speed,c={x:Math.floor(a/this.tileSize),y:Math.floor(p/this.tileSize)};c.y>=0&&c.y<i.length&&c.x>=0&&c.x<i[0].length&&i[c.y][c.x]===0?(this.position.x=a,this.position.y=p):(this.position.x=o.x*this.tileSize+this.gridOffset,this.position.y=o.y*this.tileSize+this.gridOffset)}getCurrentModeDuration(){return this.mode==="chase"?2e4:7e3}switchMode(){this.mode=this.mode==="chase"?"scatter":"chase";try{const t=Math.floor(performance.now());console.log(`Ghost ${this.color} switched to ${this.mode} at ${t}ms`)}catch{console.log(`Mode switched to ${this.mode}`)}}turnFrightened(){this.frightened=!0,this.color="blue",setTimeout(()=>{this.frightened=!1,this.color=this.originalColor},7e3)}turnEaten(){this.eaten=!0,this.frightened=!1}}class Q extends X{constructor(t){super(t),this.scatterTarget=t.scatterTarget}getTargetTile(){if(this.mode==="scatter")return this.scatterTarget;const t={x:Math.floor(this.position.x/this.tileSize),y:Math.floor(this.position.y/this.tileSize)},s={x:Math.floor(n.position.x/this.tileSize),y:Math.floor(n.position.y/this.tileSize)},i=s.x-t.x,o=s.y-t.y,l=Math.sqrt(i*i+o*o);return this.mode==="chase"&&l<=8?(this.switchMode(),this.scatterTarget):this.mode==="scatter"&&l>10?(this.switchMode(),s):this.mode==="scatter"?this.scatterTarget:s}}class U extends X{constructor(t){super(t),this.scatterTarget=t.scatterTarget,this.ambushDistance=4}getTargetTile(){if(this.mode==="scatter")return this.scatterTarget;const t={x:Math.floor(n.position.x/this.tileSize),y:Math.floor(n.position.y/this.tileSize)},s=.1;let i=t.x,o=t.y;return Math.abs(n.velocity.x)>Math.abs(n.velocity.y)?n.velocity.x>s?i+=this.ambushDistance:n.velocity.x<-s&&(i-=this.ambushDistance):n.velocity.y>s?o+=this.ambushDistance:n.velocity.y<-s&&(o-=this.ambushDistance),{x:i,y:o}}}class Z extends X{constructor(t){super(t),this.scatterTarget=t.scatterTarget}getTargetTile(){if(this.mode==="scatter")return this.scatterTarget;const t=y.find(p=>p.color==="red");if(!t)return this.fallbackTarget();const s=this.getTileCoordinates(n.position),i=this.getTileCoordinates(t.position),{offsetX:o,offsetY:l}=this.getPlayerDirectionOffset(),r={x:s.x+o*2-i.x,y:s.y+l*2-i.y},h=this.getTileCoordinates(this.position);if(Math.abs(this.position.x-(h.x*this.tileSize+this.gridOffset))<this.speed*2&&Math.abs(this.position.y-(h.y*this.tileSize+this.gridOffset))<this.speed*2){const p=xt(this.tileSize,m.width,m.height);if(!p[r.y]||p[r.y][r.x]!==0)return this.fallbackTarget()}return r}getTileCoordinates(t){return{x:Math.floor(t.x/this.tileSize),y:Math.floor(t.y/this.tileSize)}}getPlayerDirectionOffset(){return{offsetX:n.velocity.x>.1?2:n.velocity.x<-.1?-2:0,offsetY:n.velocity.y>.1?2:n.velocity.y<-.1?-2:0}}fallbackTarget(){return this.getTileCoordinates(n.position)}}class D{constructor({position:t,color:s="yellow",radius:i=2.5,points:o=10}){this.position=t,this.color=s,this.radius=i,this.collected=!1,this.points=o}draw(t){this.collected||(t.beginPath(),t.arc(this.position.x,this.position.y,this.radius,0,Math.PI*2),t.fillStyle=this.color,t.fill(),t.closePath())}checkCollision(t){return Math.hypot(t.position.x-this.position.x,t.position.y-this.position.y)<t.radius+this.radius?(this.collected=!0,!0):!1}}class Gt extends D{constructor({position:t,radius:s=5,despawnTime:i=10,points:o=100}){super({position:t,color:"red",radius:s,points:o}),this.spawnTime=Date.now(),this.despawnTimeMs=i*1e3,this.flashStartTime=this.spawnTime+this.despawnTimeMs-2e3,this.collected=!1,setTimeout(()=>{this.collected=!0},this.despawnTimeMs)}draw(t){if(this.collected)return;const s=Date.now();let i=!0;if(s>=this.flashStartTime){const l=s-this.flashStartTime;i=Math.floor(l/300)%2===0}i&&(super.draw(t),t.beginPath(),t.strokeStyle="green",t.lineWidth=2,t.moveTo(this.position.x,this.position.y-this.radius),t.lineTo(this.position.x+2,this.position.y-this.radius-2),t.stroke(),t.closePath(),t.beginPath(),t.arc(this.position.x+2.5,this.position.y-this.radius-3,1.5,0,Math.PI*2),t.fillStyle="green",t.fill(),t.closePath())}}class q extends D{constructor({position:t,radius:s=3}){super({position:t,color:"tan",radius:s,points:200}),this.visible=!0,setInterval(()=>{this.visible=!this.visible},500)}draw(t){!this.collected&&this.visible&&(t.beginPath(),t.arc(this.position.x,this.position.y,this.radius,0,Math.PI*2),t.fillStyle=this.color,t.fill(),t.closePath())}}class Y{constructor({position:t,width:s,height:i}){this.position=t,this.width=s,this.height=i}draw(t){t.fillStyle="blue",t.fillRect(this.position.x,this.position.y,this.width,this.height)}}function Ht(){for(let e of P){let t=n.position.x+n.velocity.x,s=n.position.y+n.velocity.y;if(E==!0&&(t=n.position.x+n.velocity.x*1.5,s=n.position.y+n.velocity.y*1.5),t+n.radius>=e.position.x&&t-n.radius<=e.position.x+e.width&&s+n.radius>=e.position.y&&s-n.radius<=e.position.y+e.height)return!0}return!1}class tt extends Y{constructor({position:t,width:s,height:i}){super({position:t,width:s,height:i})}draw(t){t.fillStyle="yellow",t.fillRect(this.position.x,this.position.y,this.width,this.height)}}const nt=[[0,0,10,310],[0,0,280,10],[270,0,10,310],[0,300,280,10],[130,230,20,50],[170,270,80,10],[30,270,80,10],[70,230,10,50],[200,230,10,50],[0,240,50,10],[235,240,45,10],[150,200,70,10],[60,200,70,10],[30,200,10,20],[240,200,10,20],[170,200,10,50],[100,200,10,50],[30,170,220,10],[100,130,32,10],[170,140,10,40],[100,140,10,40],[148,130,32,10],[0,140,80,10],[200,140,80,10],[0,110,50,10],[230,110,50,10],[70,80,10,40],[30,80,20,40],[230,80,20,40],[200,80,10,40],[100,40,10,70],[170,40,10,70],[130,30,20,80],[170,0,10,20],[100,0,10,20],[0,50,40,10],[240,50,40,10],[30,30,10,30],[60,0,20,30],[200,0,20,30],[240,30,10,30],[60,50,20,10],[200,50,20,10]];class et extends X{constructor(t){super(t)}getTargetTile(){return{x:Math.floor(n.position.x/this.tileSize),y:Math.floor(n.position.y/this.tileSize)}}}const lt=[],rt=[[20,20]],Xt={left:0,right:270};function mt(){const e=[];for(let t=0;t<nt.length;t++){const[s,i,o,l]=nt[t];e.push(new Y({position:{x:s,y:i},width:o,height:l}))}return e.push(new tt({position:{x:130,y:133},width:20,height:5})),e}function wt(){const e=[];for(let t=0;t<lt.length;t++){const[s,i]=lt[t];e.push(new q({position:{x:s,y:i}}))}for(let t=0;t<rt.length;t++){const[s,i]=rt[t];e.push(new D({position:{x:s,y:i}}))}return e}function it(){const e=[],s=["red","pink","cyan","orange"];for(let r=0;r<4;r++){const h=(12+r)*10+5,a=160+10/2;r===0?e.push(new et({spawnPosition:{x:h,y:a},position:{x:h,y:a},color:s[r],size:7.5})):r===1?e.push(new U({spawnPosition:{x:h,y:a},position:{x:h,y:a},color:s[r],size:7.5,scatterTarget:{x:26,y:2}})):r===2?e.push(new Z({spawnPosition:{x:h,y:a},position:{x:h,y:a},color:s[r],size:7.5,scatterTarget:{x:26,y:29}})):r===3&&e.push(new Q({spawnPosition:{x:h,y:a},position:{x:h,y:a},color:s[r],size:7.5,scatterTarget:{x:2,y:29}}))}return e}function vt(){return new st({position:{x:140,y:190},velocity:{x:0,y:0}})}const qt={x:140,y:190},Yt={x:260,y:100},at=[[0,0,420,10],[410,350,10,120],[0,140,10,190],[410,140,10,190],[0,0,10,120],[0,350,10,120],[0,460,420,10],[410,0,10,120],[30,0,10,90],[30,110,80,10],[60,30,10,90],[90,0,20,90],[380,0,10,90],[310,110,80,10],[350,30,10,90],[310,0,20,90],[130,30,160,10],[130,30,20,90],[270,30,20,90],[200,30,20,130],[170,60,80,10],[140,90,40,10],[240,90,40,10],[170,120,80,20],[170,160,80,30],[10,140,140,10],[140,140,10,50],[140,210,10,50],[140,280,10,50],[10,320,140,10],[70,140,10,80],[70,240,10,80],[30,170,20,130],[100,170,20,130],[170,220,10,40],[170,210,32,10],[218,210,32,10],[170,250,80,10],[240,220,10,40],[270,140,140,10],[270,140,10,50],[270,210,10,50],[270,280,10,50],[270,320,140,10],[340,140,10,80],[340,240,10,80],[300,170,20,130],[370,170,20,130],[30,380,10,90],[30,350,80,10],[60,350,10,90],[90,380,20,90],[380,380,10,90],[310,350,80,10],[350,350,10,90],[310,380,20,90],[130,430,160,10],[130,350,20,90],[270,350,20,90],[200,310,20,130],[170,400,80,10],[140,370,40,10],[240,370,40,10],[170,330,80,20],[170,280,80,30]],ht=[],ct=[[20,40]],Ft={left:0,right:410};function Wt(){const e=[];for(let t=0;t<at.length;t++){const[s,i,o,l]=at[t];e.push(new Y({position:{x:s,y:i},width:o,height:l}))}return e.push(new tt({position:{x:200,y:213},width:20,height:5})),e}function jt(){const e=[];for(let t=0;t<ht.length;t++){const[s,i]=ht[t];e.push(new q({position:{x:s,y:i}}))}for(let t=0;t<ct.length;t++){const[s,i]=ct[t];e.push(new D({position:{x:s,y:i}}))}return e}function Tt(){const e=[],t=["red","pink","cyan","orange"];for(let r=0;r<4;r++){const h=(19+r)*10+5,a=240+10/2;r===0?e.push(new et({spawnPosition:{x:h,y:a},position:{x:h,y:a},color:t[r],size:7.5})):r===1?e.push(new U({spawnPosition:{x:h,y:a},position:{x:h,y:a},color:t[r],size:7.5,scatterTarget:{x:40,y:2}})):r===2?e.push(new Z({spawnPosition:{x:h,y:a},position:{x:h,y:a},color:t[r],size:7.5,scatterTarget:{x:40,y:45}})):r===3&&e.push(new Q({spawnPosition:{x:h,y:a},position:{x:h,y:a},color:t[r],size:7.5,scatterTarget:{x:2,y:45}}))}return e}function Nt(){return new st({position:{x:210,y:270},velocity:{x:0,y:0}})}const Vt={x:210,y:270},Kt=[{x:190,y:50},{x:230,y:420}],dt=[[0,0,560,10],[0,0,10,300],[0,320,10,300],[0,610,560,10],[550,0,10,300],[550,320,10,300],[30,30,170,10],[220,30,50,10],[190,30,10,280],[220,30,10,40],[0,60,140,10],[30,60,10,90],[60,60,10,210],[160,60,10,160],[220,60,50,10],[260,60,10,70],[70,90,40,10],[130,90,10,130],[200,90,40,10],[90,120,40,10],[220,120,40,10],[70,150,40,10],[200,150,70,10],[30,170,40,10],[30,180,10,90],[90,180,40,10],[70,210,40,10],[70,240,100,10],[60,250,20,20],[190,240,20,70],[100,270,50,10],[170,270,20,40],[0,290,80,10],[360,30,170,10],[290,30,50,10],[360,30,10,280],[330,30,10,40],[420,60,140,10],[520,60,10,90],[490,60,10,210],[390,60,10,160],[290,60,50,10],[290,60,10,70],[450,90,40,10],[420,90,10,130],[320,90,40,10],[430,120,40,10],[300,120,40,10],[450,150,40,10],[290,150,70,10],[490,170,40,10],[520,180,10,90],[430,180,40,10],[450,210,40,10],[390,240,100,10],[480,250,20,20],[350,240,20,70],[410,270,50,10],[370,270,20,40],[480,290,80,10],[100,300,50,20],[220,180,120,10],[220,210,120,10],[230,240,100,10],[230,240,10,30],[260,240,10,30],[290,240,10,30],[320,240,10,30],[230,290,20,40],[230,290,40,10],[310,290,20,40],[290,290,40,10],[170,330,220,20],[220,370,120,10],[220,400,120,10],[220,430,120,10],[410,300,50,20],[30,580,170,10],[220,580,50,10],[190,370,10,220],[220,550,10,40],[0,550,140,10],[30,470,10,90],[60,350,10,210],[160,400,10,160],[220,550,50,10],[260,490,10,70],[70,520,40,10],[130,400,10,130],[200,520,40,10],[90,490,40,10],[220,490,40,10],[70,460,40,10],[200,460,70,10],[30,440,40,10],[30,350,10,90],[90,430,40,10],[70,400,40,10],[70,370,100,10],[100,340,50,10],[0,320,80,10],[360,580,170,10],[290,580,50,10],[360,370,10,220],[330,550,10,40],[420,550,140,10],[520,470,10,90],[490,350,10,210],[390,400,10,160],[290,550,50,10],[290,490,10,70],[450,520,40,10],[420,400,10,130],[320,520,40,10],[430,490,40,10],[300,490,40,10],[450,460,40,10],[290,460,70,10],[490,440,40,10],[520,350,10,90],[430,430,40,10],[450,400,40,10],[390,370,100,10],[410,340,50,10],[480,320,80,10]],pt=[],yt=[[20,20]],Jt={left:0,right:550};function Qt(){const e=[];for(let t=0;t<dt.length;t++){const[s,i,o,l]=dt[t];e.push(new Y({position:{x:s,y:i},width:o,height:l}))}return e.push(new tt({position:{x:270,y:292},width:20,height:5})),e}function Ut(){const e=[];for(let t=0;t<pt.length;t++){const[s,i]=pt[t];e.push(new q({position:{x:s,y:i}}))}for(let t=0;t<yt.length;t++){const[s,i]=yt[t];e.push(new D({position:{x:s,y:i}}))}return e}function St(){const e=[],t=["red","pink","cyan","orange"];for(let i=0;i<4;i++){const o=262.5+12.5*i,l=325;i===0?e.push(new et({spawnPosition:{x:o,y:l},position:{x:o,y:l},color:t[i],size:7.5})):i===1?e.push(new U({spawnPosition:{x:o,y:l},position:{x:o,y:l},color:t[i],size:7.5,scatterTarget:{x:54,y:1}})):i===2?e.push(new Z({spawnPosition:{x:285,y:325},position:{x:285,y:325},color:t[i],size:7.5,scatterTarget:{x:54,y:60}})):i===3&&e.push(new Q({spawnPosition:{x:o,y:l},position:{x:o,y:l},color:t[i],size:7.5,scatterTarget:{x:1,y:60}}))}return e}function Zt(){return new st({position:{x:280,y:570},velocity:{x:0,y:0}})}const te={x:280,y:570},ee=[{x:80,y:125},{x:510,y:80},{x:50,y:430},{x:280,y:390}];class st{constructor({position:t,velocity:s}){this.position=t,this.velocity=s,this.radius=6,this.direction="neutral",this.mouthAngle=0,this.mouthRate=.05}draw(t,s,i){t.beginPath();let o=this.position.x,l=this.position.y;t.arc(o,l,this.radius,s,i),t.lineTo(o,l),this.direction=="neutral"&&t.arc(o,l,this.radius,0,Math.PI*2),t.fillStyle="yellow",t.fill(),t.closePath()}update(t,s,i,o){(this.mouthAngle>Math.PI/4||this.mouthAngle<0)&&(this.mouthRate=-this.mouthRate),this.mouthAngle+=this.mouthRate,this.direction=="up"?this.draw(t,3*Math.PI/2+this.mouthAngle,2*Math.PI+3*Math.PI/2-this.mouthAngle):this.direction=="left"?this.draw(t,Math.PI+this.mouthAngle,2*Math.PI+Math.PI-this.mouthAngle):this.direction=="down"?this.draw(t,Math.PI/2+this.mouthAngle,2*Math.PI+Math.PI/2-this.mouthAngle):this.direction=="right"?this.draw(t,this.mouthAngle,2*Math.PI-this.mouthAngle):this.draw(t,0,Math.PI*2),i&&(this.velocity.x=0,this.velocity.y=0);const l=kt(g);l&&(this.position.x<=l.left?this.position.x=l.right+10:this.position.x>=l.right+10&&(this.position.x=l.left)),o?(this.position.x+=this.velocity.x*1.5,this.position.y+=this.velocity.y*1.5):(this.position.x+=this.velocity.x,this.position.y+=this.velocity.y)}}function ie(){b(),console.log("Respawning in 3 seconds..."),setTimeout(()=>{switch(g){case 1:n.position={...qt},y.length=0,y.push(...it());break;case 2:n.position={...Vt},y.length=0,y.push(...Tt());break;case 3:n.position={...te},y.length=0,y.push(...St());break;default:console.error("Invalid level:",g);return}n.velocity={x:0,y:0},A()},3e3)}function ut(){const e=document.createElement("div");e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.backgroundColor="rgba(255, 0, 0, 0.5)",e.style.zIndex="999",e.style.pointerEvents="none",document.body.appendChild(e),setTimeout(()=>{document.body.removeChild(e)},300)}const se="/p109/assets/pac_man_you_win-knjCyV2H.PNG",m=document.getElementById("gameCanvas")||document.querySelector("canvas"),f=m.getContext("2d"),oe=document.getElementById("pacmanRoot"),Pt=oe?.getBoundingClientRect();m.width=Pt?.width||innerWidth;m.height=Pt?.height||Math.max(innerHeight*.75,640);let z=null,n=null,k=0,F=0,P=[],d=[],S=[],y=[],g=1,I=3,ne=.5,R=100,$=0,C=!1;const le={1:[Yt],2:Kt,3:ee};let E=!1;function bt(e){k+=e}function Mt(){F++}function zt(e){z=e}function b(){z&&(cancelAnimationFrame(z),z=null)}function A(){z=requestAnimationFrame(A),f.clearRect(0,0,m.width,m.height),P.forEach(e=>e.draw(f)),n.update(f,m,Ht(),E),y.forEach(e=>{typeof e.update=="function"&&e.update(),e.draw(f,n)}),Ot();for(let e=0;e<d.length;e++)d[e].draw(f),d[e].checkCollision(n)&&(d[e]instanceof q&&(F=0,y.forEach(t=>t.turnFrightened()),E=!0,setTimeout(()=>{E=!1},7e3)),k+=d[e].points,d.splice(e,1),e--);!C&&d.length<=$*ne&&(re(),C=!0);for(let e=S.length-1;e>=0;e--){const t=S[e];if(t.collected){S.splice(e,1);continue}t.draw(f),t.checkCollision(n)&&(k+=t.points,S.splice(e,1))}$t(),gt(),d.length==0&&S.length===0&&(g++,console.log("level completed",g),Bt(),g<=3?W(g):(document.getElementById("endScImg").src=se,J(),console.log("Game completed!")))}function kt(e){switch(e){case 1:return Xt;case 2:return Ft;case 3:return Jt;default:return null}}function ot(){cancelAnimationFrame(z),k=0,g=1,P=mt(),d=wt(),n=vt(),y=it(),S=[],I=3,gt(),n.update(f,m)}function W(e){switch(b(),e){case 1:P=mt(),d=wt(),$=d.length,n=vt(),y=it(),R=100,C=!1;break;case 2:P=Wt(),d=jt(),$=d.length,n=Nt(),y=Tt(),R=300,C=!1;break;case 3:P=Qt(),d=Ut(),$=d.length,n=Zt(),y=St(),R=500,C=!1;break;default:console.error("Invalid level:",e);return}S=[],g=e,A()}function It(e){I+=e}function re(){const e=le[g],t=e[Math.floor(Math.random()*e.length)];let s;switch(g){case 1:s=15;break;case 2:s=18;break;case 3:s=20;break}S.push(new Gt({position:t,despawnTime:s,points:R}))}const ce=Object.freeze(Object.defineProperty({__proto__:null,animate:A,c:f,cancelAnimation:b,canvas:m,changeLife:It,get currentLevel(){return g},getTunnelBounds:kt,get ghosts(){return y},get ghostsEaten(){return F},incrementGhostsEaten:Mt,loadLevel:W,get maze(){return P},get pellets(){return d},get player(){return n},get playerLives(){return I},resetGame:ot,get score(){return k},setAnimationId:zt,get superpelletEaten(){return E},updateScore:bt},Symbol.toStringTag,{value:"Module"})),de=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));export{ce as g,he as i,de as m};
